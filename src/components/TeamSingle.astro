---
import Pattern from "@assets/images/pattern.svg";
import Section from "@layouts/Section.astro";
import DynamicImage from "./helpers/DynamicImage.astro";
import DynamicIcon from "./helpers/DynamicIcon.astro";

interface Props {
  employee: {
    id: number;
    name: string;
    title: string;
    description_long: string;
    past_experience: string;
    social_links: Array<{
      platform: string;
      url: string;
      icon: string;
    }>;
    slug: string;
    img: string;
  };
}

const { employee } = Astro.props;
---

<Section background="light">
  <div class="team-single-wrapper">
    <div class="team-single">
      <div class="image-stack">
        <img src={Pattern.src} alt="" class="pattern" />
        <div class="green-box"></div>
        <DynamicImage imagePath={employee.img} altText={employee.name} class="team-photo" />
      </div>

      <div class="content">
        <div class="header">
          <div class="name-title">
            <h1>{employee.name}</h1>
            <p class="job-title">{employee.title}</p>
          </div>

          <div class="divider"></div>

          <div class="social-links">
            {
              employee.social_links.map((link) => (
                <a href={link.url} class="social-icon" aria-label={link.platform}>
                  <DynamicIcon name={link.icon} class="icon" />
                </a>
              ))
            }
          </div>
        </div>

        <p class="description">{employee.description_long}</p>

        <div class="separator"></div>

        <div class="experience">
          <h2>Past experience</h2>
          <p>{employee.past_experience}</p>
        </div>
      </div>
    </div>
  </div>
</Section>

<style>
  @layer components {
    .team-single-wrapper {
      container-type: inline-size;
      container-name: team-single;
      grid-column: 1 / -1;
      width: 100%;
    }

    .team-single {
      display: grid;
      grid-template-columns: 1fr;
      gap: var(--flow-xl);
      padding-inline: var(--flow-md);
      width: 100%;
    }

    .image-stack {
      grid-row: 1;
      grid-column: 2;
      display: grid;
      position: relative;
      margin: 0 auto;
      padding: var(--flow-md);

      > * {
        grid-area: 1 / 1;
      }
    }

    .pattern {
      width: 100%;
      max-width: 388px;
      height: auto;
      aspect-ratio: 1;
      margin-top: -77px;
      margin-left: -77px;
      z-index: 0;
    }

    .green-box {
      width: 183px;
      height: 164px;
      background: var(--primary-green);
      border-radius: var(--radius-md);
      justify-self: start;
      align-self: start;
      margin-top: -20px;
      margin-left: -20px;
      z-index: 1;
    }

    :global(.team-photo) {
      width: 478px;
      height: 504px;
      border-radius: var(--radius-md);
      object-fit: cover;
      justify-self: start;
      align-self: start;
      z-index: 2;
    }

    .content {
      display: grid;
      gap: var(--flow-lg);
      width: 100%;
      z-index: 3;
    }

    .header {
      display: grid;
      grid-template-columns: 1fr;
      gap: var(--flow-lg);
      align-items: center;
    }

    .name-title {
      display: grid;
      gap: var(--flow-xs);

      h1 {
        font-family: var(--font-cabin);
        font-size: var(--h2);
        color: var(--primary-black);
        margin: 0;
      }

      .job-title {
        font-family: var(--font-cabin);
        font-size: var(--h3);
        font-weight: 400;
        line-height: 1.16;
        color: var(--text-grey);
        margin: 0;
      }
    }

    .divider {
      display: none;
    }

    .social-links {
      display: grid;
      grid-auto-flow: column;
      gap: var(--flow-md);
      justify-content: start;

      .social-icon {
        display: grid;
        place-items: center;
        color: var(--primary-black);
        transition: transform var(--transition-fast);

        :global(.icon) {
          width: var(--icon-size-md);
          height: var(--icon-size-md);
        }

        &:hover {
          transform: scale(1.1);
        }
      }
    }

    .description {
      font-family: var(--font-lato);
      font-size: var(--p);
      line-height: 1.475;
      color: var(--text-grey);
      margin: 0;
    }

    .separator {
      width: 100%;
      height: 1px;
      background: var(--border-grey);
    }

    .experience {
      display: grid;
      gap: var(--flow-sm);

      h2 {
        font-family: var(--font-cabin);
        font-size: var(--h2);
        color: var(--primary-black);
        margin: 0;
      }

      p {
        font-family: var(--font-lato);
        font-size: var(--p);
        line-height: 1.475;
        color: var(--text-grey);
        margin: 0;
      }
    }

    @container team-single (width > 1200px) {
      .team-single {
        grid-template-columns: var(--gtc-1200);
        gap: var(--flow-xxl);
        padding-inline: 0;
        padding-block: var(--flow-xxl);
        align-items: start;
      }

      .image-stack {
        grid-column: 2;
        justify-self: stretch;
        margin: 0;
        padding: 0;
      }

      .content {
        grid-row: 1;
        grid-column: 2;
        justify-self: end;
        width: 100%;
        max-width: 633px;
        gap: var(--flow-md);
      }

      .header {
        grid-template-columns: auto 1px auto;
        gap: var(--flow-xl);
      }

      .divider {
        display: block;
        width: 1px;
        height: 35px;
        background: var(--border-grey);
        transform: rotate(90deg);
      }
    }
  }
</style>
